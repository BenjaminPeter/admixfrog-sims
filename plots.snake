localrules : fig_cont, fig_rle, fig_offtarget, fig_runlengths, fig_prop

#DONE
rule fig_runlengths:
    input:
        true_raw="sims/true/SBasic_0/DHuman1_0_all_haplotypes_merged.xz",
        sim_raw="series/simfrags/A3binsMH/SBasic/DHuman1/C4archaicadmixture.xz",
        runs = 'series/A3binsMH/SBasic/R2/DHuman1/C4archaicadmixture.est.xz',
        script='plotscripts/fig_run_lengths.R'
    output:
        'figures/fraglen1_cont.png',
        'figures/fraglen2_cont.png'
    script: 'plotscripts/fig_run_lengths.R'
#
#
#DONE
rule fig_runlengths_cov:
    input:
        true_raw="sims/true/SBasic_0/DHuman1_0_all_haplotypes_merged.xz",
        sim_raw="series/simfrags/A3binsMH/SBasic/DHuman1/CN4archaicadmixture.xz",
        runs = 'series/A3binsMH/SBasic/R2/DHuman1/CN4archaicadmixture.est.xz',
        script='plotscripts/fig_run_lengths_cov.R'
    output:
        'figures/fraglen1_cov.png',
        'figures/fraglen2_cov.png'
    script: 'plotscripts/fig_run_lengths_cov.R'

#DONE
rule fig_cont:
    input:
        #'series/A1binMH/SBasic/DHuman1/C4archaicadmixture.rds',
        'series/A3binsMH/SBasic/DHuman1/C4archaicadmixture.rds',
        'series/A1binDEN/SBasic/DDen1/C4hcneaden.rds',
        #'series/A1binARC/SBasic/DDen1/C4hcneaden.rds',
        #'series/A1binDEN/SBasic/DDen1/C4archaics.rds',
        _script='plotscripts/fig_cont.R',
    output:
        'figures/fig_cont_est_den.png',
        'figures/fig_cont_est_mh.png',
        
    script: 'plotscripts/fig_cont.R'




#rerun stuff with ARC refernce
rule fig_rle:
    input:
        mh_nocont='series/A3binsMH/SBasic/R2/DHuman1/CN4archaicadmixture.class.xz',
        den_nocont='series/A1binDEN/SBasic/R4/DDen1/CN4hcneaden.class.xz',
        mh_cont='series/A3binsMH/SBasic/R2/DHuman1/C4archaicadmixture.class.xz',
        den_cont='series/A1binDEN/SBasic/R2/DDen1/C4hcneaden.class.xz',
        den_cont2='series/A1binARC/SBasic/R2/DDen1/C4hcneaden.class.xz',
        mh_r='series/A3binsMH/SBasic/RTest5/DHuman1/CN4archaicadmixture.class.xz',
    output:
        'figures/rp1.png',
        'figures/rp2.png',
        'figures/prec1.png',
        'figures/prec2.png',
        'figures/prec3.png',
        'figures/cont1.png',
        'figures/cont2_den.png',
        'figures/fig_error_rle.png',
    script: 'plotscripts/fig_rle2.R'





#needs fixing
rule fig_prop:
    input:
        'series/simfrags/A1binMH/SBasic/DHuman_prop1/CN4archaicadmixture.xz',
        'series/A1binMH/SBasic/RTest5/DHuman_prop1/CN4archaicadmixture.est.xz',
        script = 'plotscripts/fig2_prop.R',
    output:
        'figures/prop1_simfrag.png',
        'figures/prop1_estfrag.png'
    script: 'plotscripts/fig2_prop.R'
#done running
rule fig_prop_den:
    input:
        'series/simfrags/A1binDEN/SBasic/DDentime1/C4hcneaden.xz',
        'series/A1binDEN/SBasic/R2/DDentime1/C4hcneaden.est.xz',
        script = 'plotscripts/fig2_prop_den.R',
    output:
        'figures/prop1_simfrag_den.png',
        'figures/prop1_estfrag_den.png'
    script: 'plotscripts/fig2_prop_den.R'

rule fig_prop_den2:
    input:
        'series/simfrags/A1binARC/SBasic/DDentime1/C4hcneaden.xz',
        'series/A1binARC/SBasic/R2/DDentime1/C4hcneaden.est.xz',
        'series/simfrags/A1binDEN/SBasic/DDentime1/C4archaics.xz',
        'series/A1binDEN/SBasic/R2/DDentime1/C4archaics.est.xz',
        'series/simfrags/A1binDEN/SBasic/DDentime1/CN4hcneaden.xz',
        'series/A1binDEN/SBasic/R2/DDentime1/CN4hcneaden.est.xz',
        script = 'plotscripts/fig2_prop.R',
    output:
        'figures/prop1_simfrag.png'
        'figures/prop1_estfrag.png'
    script: 'plotscripts/fig2_prop.R'

        
#complete script
rule fig_offtarget:
    input:
        mh_nocont='series/A1bin2MH/SBasic/R2/DHumanDenAdmix1/CN4archaicadmixture.class.xz',
        script='plotscripts/fig_rle2.R'
    output:
        'figures/offtarget.png'
    script: 'plotscripts/fig_rle2.R'

        
